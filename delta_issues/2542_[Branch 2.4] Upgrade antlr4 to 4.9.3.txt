Cherry-pick #1751