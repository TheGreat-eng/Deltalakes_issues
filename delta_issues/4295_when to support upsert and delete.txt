when to support upsert and delete ?