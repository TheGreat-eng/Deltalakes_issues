Cherry-pick of 800065bf0553ace7dbc87ac0e83369f2dd358c58 from branch-3.1 to master
