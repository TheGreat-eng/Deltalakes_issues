Cherry-pick fc81d1247d66cc32e454e985f0cfc81447f897b6 to `branch-3.3`