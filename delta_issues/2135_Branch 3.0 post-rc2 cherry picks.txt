cherry-picks from `master` into `branch-3.0`
- 41c5179bb5f9b21987fce54fa5928c61c9a1955e
- 962495e64b314c7272b9d7ea34cd0c678834a1b0
